---
phase: 2
plan: 2
wave: 1
---

# Plan 2.2: Login Form Integration

## Objective
Connect the login form in `login.html` to the backend `/api/login` endpoint and manage the user's logged-in state.

## Context
- .gsd/SPEC.md
- frontend/js/login.js
- backend/main.py

## Tasks

<task type="auto">
  <name>Update Login JS Logic</name>
  <files>frontend/js/login.js</files>
  <action>
    Modify the submit event listener in `frontend/js/login.js`:
    - Replace the `setTimeout` simulation with a real `fetch` call to `http://localhost:8000/api/login`.
    - Send `email` and `password` as JSON.
    - Handle success: 
      - Save user data (email, fullname) to `localStorage`.
      - Redirect to `index.html`.
    - Handle error: Show "Invalid email or password" using `showError`.
  </action>
  <verify>Login with correct and incorrect credentials to verify behavior.</verify>
  <done>User can log in and is redirected on success.</done>
</task>

<task type="auto">
  <name>Update Homepage for Logged-in State</name>
  <files>frontend/js/global.js</files>
  <action>
    Update or create logic in `frontend/js/global.js` (or similar) to:
    - Check `localStorage` for user info on page load.
    - If user is logged in, replace the "Login" button in the navbar with the user's name or a "Logout" button.
  </action>
  <verify>Log in and check if the navbar reflects the logged-in state on index.html.</verify>
  <done>UI reflects logged-in state.</done>
</task>

## Success Criteria
- [ ] Login works against the real backend.
- [ ] User state persists in the browser session.
- [ ] UI updates to show logged-in status.
