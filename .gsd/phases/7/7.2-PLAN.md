---
phase: 7
plan: 2
wave: 2
---

# Plan 7.2: Implement Logging in Health Routes

## Objective
Integrate the logging mechanism into the individual health assessment services so that every assessment is recorded for the admin dashboard.

## Context
- backend/routes/heart.py
- backend/routes/diabetes.py
- backend/routes/parkinsons.py
- backend/database.py
- backend/utils.py

## Tasks

<task type="auto">
  <name>Update Heart Disease Risk Logging</name>
  <files>
    - backend/routes/heart.py
  </files>
  <action>
    1. Import `log_prediction` from `backend.database` and `get_email` from `utils`.
    2. Inside the "Assess" button logic, after successful prediction:
       - Get email using `get_email()`.
       - Prepare inputs string (e.g., a comma-separated list of key metrics).
       - Call `log_prediction(email, "Heart Disease", inputs, outcome_string)`.
  </action>
  <verify>
    Ensure the `import` statement uses the correct relative/absolute path established in the file.
  </verify>
  <done>
    Heart assessments are logged to the database.
  </done>
</task>

<task type="auto">
  <name>Update Diabetes and Parkinson's Logging</name>
  <files>
    - backend/routes/diabetes.py
    - backend/routes/parkinsons.py
  </files>
  <action>
    Repeat the logging integration for `diabetes.py` and `parkinsons.py`:
    1. Import necessary helpers.
    2. Log prediction results (type "Diabetes" and "Parkinson's") along with inputs and user email.
  </action>
  <verify>
    Check that assessments are correctly categorized by type in the database.
  </verify>
  <done>
    All health assessment routes now log data.
  </done>
</task>

## Success Criteria
- [ ] Database `predictions` table is populated when users run assessments.
- [ ] Admin dashboard "Recent Activity" table starts showing live data.
